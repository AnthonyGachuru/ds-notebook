<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 13 Frameworks | Data Science Cribsheet</title>
  <meta name="description" content="A collection of quick notes on the field.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 13 Frameworks | Data Science Cribsheet" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A collection of quick notes on the field." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Frameworks | Data Science Cribsheet" />
  
  <meta name="twitter:description" content="A collection of quick notes on the field." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="code-snippets.html">
<link rel="next" href="resources.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DS Cribsheet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workflow</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#preamble"><i class="fa fa-check"></i><b>1.1</b> Preamble</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#checklist"><i class="fa fa-check"></i><b>1.2</b> Checklist</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#preparation"><i class="fa fa-check"></i><b>1.2.1</b> Preparation</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#import"><i class="fa fa-check"></i><b>1.2.2</b> Import</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#tidy"><i class="fa fa-check"></i><b>1.2.3</b> Tidy</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#transform"><i class="fa fa-check"></i><b>1.2.4</b> Transform</a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#visualize"><i class="fa fa-check"></i><b>1.2.5</b> Visualize</a></li>
<li class="chapter" data-level="1.2.6" data-path="index.html"><a href="index.html#model"><i class="fa fa-check"></i><b>1.2.6</b> Model</a></li>
<li class="chapter" data-level="1.2.7" data-path="index.html"><a href="index.html#communicate"><i class="fa fa-check"></i><b>1.2.7</b> Communicate</a></li>
<li class="chapter" data-level="1.2.8" data-path="index.html"><a href="index.html#deployment-maintenance"><i class="fa fa-check"></i><b>1.2.8</b> Deployment / Maintenance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html"><i class="fa fa-check"></i><b>2</b> Import, Tidy, Transform &amp; Visualize</a><ul>
<li class="chapter" data-level="2.1" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#import-1"><i class="fa fa-check"></i><b>2.1</b> Import</a><ul>
<li class="chapter" data-level="2.1.1" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#general"><i class="fa fa-check"></i><b>2.1.1</b> General</a></li>
<li class="chapter" data-level="2.1.2" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#sql"><i class="fa fa-check"></i><b>2.1.2</b> SQL</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#tidy-1"><i class="fa fa-check"></i><b>2.2</b> Tidy</a></li>
<li class="chapter" data-level="2.3" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#transform-1"><i class="fa fa-check"></i><b>2.3</b> Transform</a><ul>
<li class="chapter" data-level="2.3.1" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#general-1"><i class="fa fa-check"></i><b>2.3.1</b> General</a></li>
<li class="chapter" data-level="2.3.2" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#missingness-imputation"><i class="fa fa-check"></i><b>2.3.2</b> Missingness &amp; Imputation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="import-tidy-transform-visualize.html"><a href="import-tidy-transform-visualize.html#visualize-1"><i class="fa fa-check"></i><b>2.4</b> Visualize</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html"><i class="fa fa-check"></i><b>3</b> Pre-processing, Feature Selection, and Feature Engineering</a><ul>
<li class="chapter" data-level="3.1" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#general-2"><i class="fa fa-check"></i><b>3.1</b> General</a></li>
<li class="chapter" data-level="3.2" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#pre-processing"><i class="fa fa-check"></i><b>3.2</b> Pre-processing</a></li>
<li class="chapter" data-level="3.3" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#feature-engineering"><i class="fa fa-check"></i><b>3.3</b> Feature Engineering</a></li>
<li class="chapter" data-level="3.4" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#feature-selection"><i class="fa fa-check"></i><b>3.4</b> Feature Selection</a></li>
<li class="chapter" data-level="3.5" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#other"><i class="fa fa-check"></i><b>3.5</b> Other</a><ul>
<li class="chapter" data-level="3.5.1" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#unbalanced-classes"><i class="fa fa-check"></i><b>3.5.1</b> Unbalanced Classes</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#model-selection"><i class="fa fa-check"></i><b>3.6</b> Model Selection</a><ul>
<li class="chapter" data-level="3.6.1" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#general-3"><i class="fa fa-check"></i><b>3.6.1</b> General</a></li>
<li class="chapter" data-level="3.6.2" data-path="pre-processing-feature-selection-and-feature-engineering.html"><a href="pre-processing-feature-selection-and-feature-engineering.html#clustering"><i class="fa fa-check"></i><b>3.6.2</b> Clustering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="model-1.html"><a href="model-1.html"><i class="fa fa-check"></i><b>4</b> Model</a><ul>
<li class="chapter" data-level="4.1" data-path="model-1.html"><a href="model-1.html#supervised"><i class="fa fa-check"></i><b>4.1</b> Supervised</a><ul>
<li class="chapter" data-level="4.1.1" data-path="model-1.html"><a href="model-1.html#linear-regression"><i class="fa fa-check"></i><b>4.1.1</b> Linear Regression</a></li>
<li class="chapter" data-level="4.1.2" data-path="model-1.html"><a href="model-1.html#selection"><i class="fa fa-check"></i><b>4.1.2</b> Selection</a></li>
<li class="chapter" data-level="4.1.3" data-path="model-1.html"><a href="model-1.html#proscons"><i class="fa fa-check"></i><b>4.1.3</b> Pros/Cons</a></li>
<li class="chapter" data-level="4.1.4" data-path="model-1.html"><a href="model-1.html#other-1"><i class="fa fa-check"></i><b>4.1.4</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="model-1.html"><a href="model-1.html#ridgelasso"><i class="fa fa-check"></i><b>4.2</b> Ridge/Lasso</a><ul>
<li class="chapter" data-level="4.2.1" data-path="model-1.html"><a href="model-1.html#intro"><i class="fa fa-check"></i><b>4.2.1</b> Intro</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="model-1.html"><a href="model-1.html#logistic-regression"><i class="fa fa-check"></i><b>4.3</b> Logistic Regression</a><ul>
<li class="chapter" data-level="4.3.1" data-path="model-1.html"><a href="model-1.html#intro-1"><i class="fa fa-check"></i><b>4.3.1</b> Intro</a></li>
<li class="chapter" data-level="4.3.2" data-path="model-1.html"><a href="model-1.html#assumptions"><i class="fa fa-check"></i><b>4.3.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.3.3" data-path="model-1.html"><a href="model-1.html#evaluation"><i class="fa fa-check"></i><b>4.3.3</b> Evaluation</a></li>
<li class="chapter" data-level="4.3.4" data-path="model-1.html"><a href="model-1.html#proscons-1"><i class="fa fa-check"></i><b>4.3.4</b> Pros/Cons</a></li>
<li class="chapter" data-level="4.3.5" data-path="model-1.html"><a href="model-1.html#code-example"><i class="fa fa-check"></i><b>4.3.5</b> Code Example</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="model-1.html"><a href="model-1.html#poisson-regression"><i class="fa fa-check"></i><b>4.4</b> Poisson Regression</a><ul>
<li class="chapter" data-level="4.4.1" data-path="model-1.html"><a href="model-1.html#intro-2"><i class="fa fa-check"></i><b>4.4.1</b> Intro</a></li>
<li class="chapter" data-level="4.4.2" data-path="model-1.html"><a href="model-1.html#assumptions-1"><i class="fa fa-check"></i><b>4.4.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.4.3" data-path="model-1.html"><a href="model-1.html#evaluation-1"><i class="fa fa-check"></i><b>4.4.3</b> Evaluation</a></li>
<li class="chapter" data-level="4.4.4" data-path="model-1.html"><a href="model-1.html#proscons-2"><i class="fa fa-check"></i><b>4.4.4</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="model-1.html"><a href="model-1.html#generalized-additive-models"><i class="fa fa-check"></i><b>4.5</b> Generalized Additive Models</a><ul>
<li class="chapter" data-level="4.5.1" data-path="model-1.html"><a href="model-1.html#intro-3"><i class="fa fa-check"></i><b>4.5.1</b> Intro</a></li>
<li class="chapter" data-level="4.5.2" data-path="model-1.html"><a href="model-1.html#assumptions-2"><i class="fa fa-check"></i><b>4.5.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.5.3" data-path="model-1.html"><a href="model-1.html#evaluation-2"><i class="fa fa-check"></i><b>4.5.3</b> Evaluation</a></li>
<li class="chapter" data-level="4.5.4" data-path="model-1.html"><a href="model-1.html#proscons-3"><i class="fa fa-check"></i><b>4.5.4</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="model-1.html"><a href="model-1.html#k-means-clustering-us"><i class="fa fa-check"></i><b>4.6</b> K-Means Clustering [US]</a><ul>
<li class="chapter" data-level="4.6.1" data-path="model-1.html"><a href="model-1.html#intro-4"><i class="fa fa-check"></i><b>4.6.1</b> Intro</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="model-1.html"><a href="model-1.html#hierarchical-clustering"><i class="fa fa-check"></i><b>4.7</b> Hierarchical Clustering</a><ul>
<li class="chapter" data-level="4.7.1" data-path="model-1.html"><a href="model-1.html#assumptions-3"><i class="fa fa-check"></i><b>4.7.1</b> Assumptions</a></li>
<li class="chapter" data-level="4.7.2" data-path="model-1.html"><a href="model-1.html#characteristics"><i class="fa fa-check"></i><b>4.7.2</b> Characteristics</a></li>
<li class="chapter" data-level="4.7.3" data-path="model-1.html"><a href="model-1.html#evaluation-3"><i class="fa fa-check"></i><b>4.7.3</b> Evaluation</a></li>
<li class="chapter" data-level="4.7.4" data-path="model-1.html"><a href="model-1.html#proscons-4"><i class="fa fa-check"></i><b>4.7.4</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="model-1.html"><a href="model-1.html#pca"><i class="fa fa-check"></i><b>4.8</b> PCA</a><ul>
<li class="chapter" data-level="4.8.1" data-path="model-1.html"><a href="model-1.html#intro-5"><i class="fa fa-check"></i><b>4.8.1</b> Intro</a></li>
<li class="chapter" data-level="4.8.2" data-path="model-1.html"><a href="model-1.html#assumptions-4"><i class="fa fa-check"></i><b>4.8.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.8.3" data-path="model-1.html"><a href="model-1.html#characteristics-1"><i class="fa fa-check"></i><b>4.8.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.8.4" data-path="model-1.html"><a href="model-1.html#evaluation-4"><i class="fa fa-check"></i><b>4.8.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.8.5" data-path="model-1.html"><a href="model-1.html#proscons-5"><i class="fa fa-check"></i><b>4.8.5</b> Pros/Cons</a></li>
<li class="chapter" data-level="4.8.6" data-path="model-1.html"><a href="model-1.html#other-2"><i class="fa fa-check"></i><b>4.8.6</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="model-1.html"><a href="model-1.html#knn"><i class="fa fa-check"></i><b>4.9</b> KNN</a><ul>
<li class="chapter" data-level="4.9.1" data-path="model-1.html"><a href="model-1.html#intro-6"><i class="fa fa-check"></i><b>4.9.1</b> Intro</a></li>
<li class="chapter" data-level="4.9.2" data-path="model-1.html"><a href="model-1.html#assumptions-5"><i class="fa fa-check"></i><b>4.9.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.9.3" data-path="model-1.html"><a href="model-1.html#characteristics-2"><i class="fa fa-check"></i><b>4.9.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.9.4" data-path="model-1.html"><a href="model-1.html#evaluation-5"><i class="fa fa-check"></i><b>4.9.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.9.5" data-path="model-1.html"><a href="model-1.html#proscons-6"><i class="fa fa-check"></i><b>4.9.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="model-1.html"><a href="model-1.html#svm"><i class="fa fa-check"></i><b>4.10</b> SVM</a><ul>
<li class="chapter" data-level="4.10.1" data-path="model-1.html"><a href="model-1.html#intro-7"><i class="fa fa-check"></i><b>4.10.1</b> Intro</a></li>
<li class="chapter" data-level="4.10.2" data-path="model-1.html"><a href="model-1.html#assumptions-6"><i class="fa fa-check"></i><b>4.10.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.10.3" data-path="model-1.html"><a href="model-1.html#characteristics-3"><i class="fa fa-check"></i><b>4.10.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.10.4" data-path="model-1.html"><a href="model-1.html#evaluation-6"><i class="fa fa-check"></i><b>4.10.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.10.5" data-path="model-1.html"><a href="model-1.html#proscons-7"><i class="fa fa-check"></i><b>4.10.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="model-1.html"><a href="model-1.html#decision-tree"><i class="fa fa-check"></i><b>4.11</b> Decision Tree</a><ul>
<li class="chapter" data-level="4.11.1" data-path="model-1.html"><a href="model-1.html#intro-8"><i class="fa fa-check"></i><b>4.11.1</b> Intro</a></li>
<li class="chapter" data-level="4.11.2" data-path="model-1.html"><a href="model-1.html#assumptions-7"><i class="fa fa-check"></i><b>4.11.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.11.3" data-path="model-1.html"><a href="model-1.html#characteristics-4"><i class="fa fa-check"></i><b>4.11.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.11.4" data-path="model-1.html"><a href="model-1.html#evaluation-7"><i class="fa fa-check"></i><b>4.11.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.11.5" data-path="model-1.html"><a href="model-1.html#proscons-8"><i class="fa fa-check"></i><b>4.11.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="model-1.html"><a href="model-1.html#bagging"><i class="fa fa-check"></i><b>4.12</b> Bagging</a><ul>
<li class="chapter" data-level="4.12.1" data-path="model-1.html"><a href="model-1.html#intro-9"><i class="fa fa-check"></i><b>4.12.1</b> Intro</a></li>
<li class="chapter" data-level="4.12.2" data-path="model-1.html"><a href="model-1.html#assumptions-8"><i class="fa fa-check"></i><b>4.12.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.12.3" data-path="model-1.html"><a href="model-1.html#characteristics-5"><i class="fa fa-check"></i><b>4.12.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.12.4" data-path="model-1.html"><a href="model-1.html#evaluation-8"><i class="fa fa-check"></i><b>4.12.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.12.5" data-path="model-1.html"><a href="model-1.html#proscons-9"><i class="fa fa-check"></i><b>4.12.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="model-1.html"><a href="model-1.html#random-forest"><i class="fa fa-check"></i><b>4.13</b> Random Forest</a><ul>
<li class="chapter" data-level="4.13.1" data-path="model-1.html"><a href="model-1.html#intro-10"><i class="fa fa-check"></i><b>4.13.1</b> Intro</a></li>
<li class="chapter" data-level="4.13.2" data-path="model-1.html"><a href="model-1.html#assumptions-9"><i class="fa fa-check"></i><b>4.13.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.13.3" data-path="model-1.html"><a href="model-1.html#characteristics-6"><i class="fa fa-check"></i><b>4.13.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.13.4" data-path="model-1.html"><a href="model-1.html#evaluation-9"><i class="fa fa-check"></i><b>4.13.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.13.5" data-path="model-1.html"><a href="model-1.html#proscons-10"><i class="fa fa-check"></i><b>4.13.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="model-1.html"><a href="model-1.html#boosting"><i class="fa fa-check"></i><b>4.14</b> Boosting</a><ul>
<li class="chapter" data-level="4.14.1" data-path="model-1.html"><a href="model-1.html#intro-11"><i class="fa fa-check"></i><b>4.14.1</b> Intro</a></li>
<li class="chapter" data-level="4.14.2" data-path="model-1.html"><a href="model-1.html#assumptions-10"><i class="fa fa-check"></i><b>4.14.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.14.3" data-path="model-1.html"><a href="model-1.html#characteristics-7"><i class="fa fa-check"></i><b>4.14.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.14.4" data-path="model-1.html"><a href="model-1.html#evaluation-10"><i class="fa fa-check"></i><b>4.14.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.14.5" data-path="model-1.html"><a href="model-1.html#proscons-11"><i class="fa fa-check"></i><b>4.14.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="model-1.html"><a href="model-1.html#association-rule-mining"><i class="fa fa-check"></i><b>4.15</b> Association Rule Mining</a><ul>
<li class="chapter" data-level="4.15.1" data-path="model-1.html"><a href="model-1.html#intro-12"><i class="fa fa-check"></i><b>4.15.1</b> Intro</a></li>
<li class="chapter" data-level="4.15.2" data-path="model-1.html"><a href="model-1.html#assumptions-11"><i class="fa fa-check"></i><b>4.15.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.15.3" data-path="model-1.html"><a href="model-1.html#characteristics-8"><i class="fa fa-check"></i><b>4.15.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.15.4" data-path="model-1.html"><a href="model-1.html#evaluation-11"><i class="fa fa-check"></i><b>4.15.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.15.5" data-path="model-1.html"><a href="model-1.html#proscons-12"><i class="fa fa-check"></i><b>4.15.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="model-1.html"><a href="model-1.html#naive-bayes"><i class="fa fa-check"></i><b>4.16</b> Naïve Bayes</a><ul>
<li class="chapter" data-level="4.16.1" data-path="model-1.html"><a href="model-1.html#intro-13"><i class="fa fa-check"></i><b>4.16.1</b> Intro</a></li>
<li class="chapter" data-level="4.16.2" data-path="model-1.html"><a href="model-1.html#assumptions-12"><i class="fa fa-check"></i><b>4.16.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.16.3" data-path="model-1.html"><a href="model-1.html#characteristics-9"><i class="fa fa-check"></i><b>4.16.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.16.4" data-path="model-1.html"><a href="model-1.html#evaluation-12"><i class="fa fa-check"></i><b>4.16.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.16.5" data-path="model-1.html"><a href="model-1.html#proscons-13"><i class="fa fa-check"></i><b>4.16.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.17" data-path="model-1.html"><a href="model-1.html#lda"><i class="fa fa-check"></i><b>4.17</b> LDA</a><ul>
<li class="chapter" data-level="4.17.1" data-path="model-1.html"><a href="model-1.html#intro-14"><i class="fa fa-check"></i><b>4.17.1</b> Intro</a></li>
<li class="chapter" data-level="4.17.2" data-path="model-1.html"><a href="model-1.html#assumptions-13"><i class="fa fa-check"></i><b>4.17.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.17.3" data-path="model-1.html"><a href="model-1.html#characteristics-10"><i class="fa fa-check"></i><b>4.17.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.17.4" data-path="model-1.html"><a href="model-1.html#evaluation-13"><i class="fa fa-check"></i><b>4.17.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.17.5" data-path="model-1.html"><a href="model-1.html#proscons-14"><i class="fa fa-check"></i><b>4.17.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.18" data-path="model-1.html"><a href="model-1.html#qda"><i class="fa fa-check"></i><b>4.18</b> QDA</a><ul>
<li class="chapter" data-level="4.18.1" data-path="model-1.html"><a href="model-1.html#intro-15"><i class="fa fa-check"></i><b>4.18.1</b> Intro</a></li>
<li class="chapter" data-level="4.18.2" data-path="model-1.html"><a href="model-1.html#assumptions-14"><i class="fa fa-check"></i><b>4.18.2</b> Assumptions</a></li>
<li class="chapter" data-level="4.18.3" data-path="model-1.html"><a href="model-1.html#characteristics-11"><i class="fa fa-check"></i><b>4.18.3</b> Characteristics</a></li>
<li class="chapter" data-level="4.18.4" data-path="model-1.html"><a href="model-1.html#evaluation-14"><i class="fa fa-check"></i><b>4.18.4</b> Evaluation</a></li>
<li class="chapter" data-level="4.18.5" data-path="model-1.html"><a href="model-1.html#proscons-15"><i class="fa fa-check"></i><b>4.18.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="4.19" data-path="model-1.html"><a href="model-1.html#datacamp-nonlinear-modeling-in-r-with-gams"><i class="fa fa-check"></i><b>4.19</b> DataCamp: Nonlinear Modeling in R with GAMs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>5</b> Hierarchical Models</a></li>
<li class="chapter" data-level="6" data-path="communicate-deploy-maintain.html"><a href="communicate-deploy-maintain.html"><i class="fa fa-check"></i><b>6</b> Communicate, Deploy, Maintain</a><ul>
<li class="chapter" data-level="6.1" data-path="communicate-deploy-maintain.html"><a href="communicate-deploy-maintain.html#communicate-1"><i class="fa fa-check"></i><b>6.1</b> Communicate</a></li>
<li class="chapter" data-level="6.2" data-path="communicate-deploy-maintain.html"><a href="communicate-deploy-maintain.html#deploy"><i class="fa fa-check"></i><b>6.2</b> Deploy</a></li>
<li class="chapter" data-level="6.3" data-path="communicate-deploy-maintain.html"><a href="communicate-deploy-maintain.html#maintain"><i class="fa fa-check"></i><b>6.3</b> Maintain</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>7</b> Time Series</a><ul>
<li class="chapter" data-level="7.1" data-path="time-series.html"><a href="time-series.html#notes"><i class="fa fa-check"></i><b>7.1</b> Notes</a></li>
<li class="chapter" data-level="7.2" data-path="time-series.html"><a href="time-series.html#packages"><i class="fa fa-check"></i><b>7.2</b> Packages</a></li>
<li class="chapter" data-level="7.3" data-path="time-series.html"><a href="time-series.html#data-conversion"><i class="fa fa-check"></i><b>7.3</b> Data Conversion</a></li>
<li class="chapter" data-level="7.4" data-path="time-series.html"><a href="time-series.html#models"><i class="fa fa-check"></i><b>7.4</b> Models</a><ul>
<li class="chapter" data-level="7.4.1" data-path="time-series.html"><a href="time-series.html#intro-16"><i class="fa fa-check"></i><b>7.4.1</b> Intro</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series.html"><a href="time-series.html#assumptions-15"><i class="fa fa-check"></i><b>7.4.2</b> Assumptions</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series.html"><a href="time-series.html#characteristics-12"><i class="fa fa-check"></i><b>7.4.3</b> Characteristics</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series.html"><a href="time-series.html#evaluation-15"><i class="fa fa-check"></i><b>7.4.4</b> Evaluation</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series.html"><a href="time-series.html#proscons-16"><i class="fa fa-check"></i><b>7.4.5</b> Pros/Cons</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series.html"><a href="time-series.html#dsp"><i class="fa fa-check"></i><b>7.5</b> DSP</a></li>
<li class="chapter" data-level="7.6" data-path="time-series.html"><a href="time-series.html#forecasting-principles-practice"><i class="fa fa-check"></i><b>7.6</b> Forecasting: Principles &amp; Practice</a><ul>
<li class="chapter" data-level="7.6.1" data-path="time-series.html"><a href="time-series.html#c1-3"><i class="fa fa-check"></i><b>7.6.1</b> C1-3</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series.html"><a href="time-series.html#c4"><i class="fa fa-check"></i><b>7.6.2</b> C4</a></li>
<li class="chapter" data-level="7.6.3" data-path="time-series.html"><a href="time-series.html#c5"><i class="fa fa-check"></i><b>7.6.3</b> C5</a></li>
<li class="chapter" data-level="7.6.4" data-path="time-series.html"><a href="time-series.html#c6"><i class="fa fa-check"></i><b>7.6.4</b> C6</a></li>
<li class="chapter" data-level="7.6.5" data-path="time-series.html"><a href="time-series.html#c7"><i class="fa fa-check"></i><b>7.6.5</b> C7</a></li>
<li class="chapter" data-level="7.6.6" data-path="time-series.html"><a href="time-series.html#c8-arima"><i class="fa fa-check"></i><b>7.6.6</b> C8: arima</a></li>
<li class="chapter" data-level="7.6.7" data-path="time-series.html"><a href="time-series.html#c9"><i class="fa fa-check"></i><b>7.6.7</b> C9</a></li>
<li class="chapter" data-level="7.6.8" data-path="time-series.html"><a href="time-series.html#c10"><i class="fa fa-check"></i><b>7.6.8</b> C10</a></li>
<li class="chapter" data-level="7.6.9" data-path="time-series.html"><a href="time-series.html#c11"><i class="fa fa-check"></i><b>7.6.9</b> C11</a></li>
<li class="chapter" data-level="7.6.10" data-path="time-series.html"><a href="time-series.html#c12"><i class="fa fa-check"></i><b>7.6.10</b> C12</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series.html"><a href="time-series.html#forecasting-datacamp"><i class="fa fa-check"></i><b>7.7</b> Forecasting Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>8</b> Stats</a><ul>
<li class="chapter" data-level="8.1" data-path="stats.html"><a href="stats.html#general-4"><i class="fa fa-check"></i><b>8.1</b> General</a><ul>
<li class="chapter" data-level="" data-path="stats.html"><a href="stats.html#introduction-to-data"><i class="fa fa-check"></i>Introduction to Data</a></li>
<li class="chapter" data-level="8.1.1" data-path="stats.html"><a href="stats.html#statistical-tests"><i class="fa fa-check"></i><b>8.1.1</b> Statistical Tests</a></li>
<li class="chapter" data-level="8.1.2" data-path="stats.html"><a href="stats.html#stats-for-hackers"><i class="fa fa-check"></i><b>8.1.2</b> Stats For Hackers</a></li>
<li class="chapter" data-level="8.1.3" data-path="stats.html"><a href="stats.html#think-stats"><i class="fa fa-check"></i><b>8.1.3</b> Think Stats</a></li>
<li class="chapter" data-level="8.1.4" data-path="stats.html"><a href="stats.html#ab-testing-overview"><i class="fa fa-check"></i><b>8.1.4</b> AB Testing Overview</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="stats.html"><a href="stats.html#datacamp-experimental-design"><i class="fa fa-check"></i><b>8.2</b> DataCamp: Experimental Design</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>9</b> Deep Learning</a><ul>
<li class="chapter" data-level="9.1" data-path="deep-learning.html"><a href="deep-learning.html#general-5"><i class="fa fa-check"></i><b>9.1</b> General</a></li>
<li class="chapter" data-level="9.2" data-path="deep-learning.html"><a href="deep-learning.html#lstms"><i class="fa fa-check"></i><b>9.2</b> LSTMs</a></li>
<li class="chapter" data-level="9.3" data-path="deep-learning.html"><a href="deep-learning.html#dl.ai-intro"><i class="fa fa-check"></i><b>9.3</b> DL.AI: Intro</a></li>
<li class="chapter" data-level="9.4" data-path="deep-learning.html"><a href="deep-learning.html#dl.ai-improving-deep-neural-network"><i class="fa fa-check"></i><b>9.4</b> DL.AI: Improving Deep Neural Network</a><ul>
<li class="chapter" data-level="9.4.1" data-path="deep-learning.html"><a href="deep-learning.html#optimization-algorithms"><i class="fa fa-check"></i><b>9.4.1</b> Optimization Algorithms</a></li>
<li class="chapter" data-level="9.4.2" data-path="deep-learning.html"><a href="deep-learning.html#hyperparameter-tuning"><i class="fa fa-check"></i><b>9.4.2</b> Hyperparameter Tuning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="probabilistic-programming.html"><a href="probabilistic-programming.html"><i class="fa fa-check"></i><b>10</b> Probabilistic Programming</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilistic-programming.html"><a href="probabilistic-programming.html#doing-bayesian-da"><i class="fa fa-check"></i><b>10.1</b> Doing Bayesian DA</a></li>
<li class="chapter" data-level="10.2" data-path="probabilistic-programming.html"><a href="probabilistic-programming.html#statistical-rethinking"><i class="fa fa-check"></i><b>10.2</b> Statistical Rethinking</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="notes-1.html"><a href="notes-1.html"><i class="fa fa-check"></i><b>11</b> Notes</a><ul>
<li class="chapter" data-level="11.1" data-path="notes-1.html"><a href="notes-1.html#other-3"><i class="fa fa-check"></i><b>11.1</b> Other</a><ul>
<li class="chapter" data-level="11.1.1" data-path="notes-1.html"><a href="notes-1.html#vanderplas-jupyter"><i class="fa fa-check"></i><b>11.1.1</b> Vanderplas Jupyter</a></li>
<li class="chapter" data-level="11.1.2" data-path="notes-1.html"><a href="notes-1.html#sample-r-pipeline"><i class="fa fa-check"></i><b>11.1.2</b> Sample R Pipeline</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-snippets.html"><a href="code-snippets.html"><i class="fa fa-check"></i><b>12</b> Code Snippets</a><ul>
<li class="chapter" data-level="12.1" data-path="code-snippets.html"><a href="code-snippets.html#albon"><i class="fa fa-check"></i><b>12.1</b> Albon</a></li>
<li class="chapter" data-level="12.2" data-path="code-snippets.html"><a href="code-snippets.html#rowwise"><i class="fa fa-check"></i><b>12.2</b> Rowwise</a></li>
<li class="chapter" data-level="12.3" data-path="code-snippets.html"><a href="code-snippets.html#sampling-file"><i class="fa fa-check"></i><b>12.3</b> Sampling File</a></li>
<li class="chapter" data-level="12.4" data-path="code-snippets.html"><a href="code-snippets.html#hold"><i class="fa fa-check"></i><b>12.4</b> Hold</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="frameworks.html"><a href="frameworks.html"><i class="fa fa-check"></i><b>13</b> Frameworks</a><ul>
<li class="chapter" data-level="13.1" data-path="frameworks.html"><a href="frameworks.html#pyspark"><i class="fa fa-check"></i><b>13.1</b> PySpark</a></li>
<li class="chapter" data-level="13.2" data-path="frameworks.html"><a href="frameworks.html#sparklyr"><i class="fa fa-check"></i><b>13.2</b> Sparklyr</a></li>
<li class="chapter" data-level="13.3" data-path="frameworks.html"><a href="frameworks.html#caret"><i class="fa fa-check"></i><b>13.3</b> Caret</a><ul>
<li class="chapter" data-level="13.3.1" data-path="frameworks.html"><a href="frameworks.html#preprocessing"><i class="fa fa-check"></i><b>13.3.1</b> Preprocessing</a></li>
<li class="chapter" data-level="13.3.2" data-path="frameworks.html"><a href="frameworks.html#lm"><i class="fa fa-check"></i><b>13.3.2</b> LM</a></li>
<li class="chapter" data-level="13.3.3" data-path="frameworks.html"><a href="frameworks.html#lassoridge"><i class="fa fa-check"></i><b>13.3.3</b> Lasso/Ridge</a></li>
<li class="chapter" data-level="13.3.4" data-path="frameworks.html"><a href="frameworks.html#logistic-regression-1"><i class="fa fa-check"></i><b>13.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="13.3.5" data-path="frameworks.html"><a href="frameworks.html#train-test-split-folds-cv"><i class="fa fa-check"></i><b>13.3.5</b> Train-Test Split, Folds, &amp; CV</a></li>
<li class="chapter" data-level="13.3.6" data-path="frameworks.html"><a href="frameworks.html#random-forest-1"><i class="fa fa-check"></i><b>13.3.6</b> Random Forest</a></li>
<li class="chapter" data-level="13.3.7" data-path="frameworks.html"><a href="frameworks.html#svm-1"><i class="fa fa-check"></i><b>13.3.7</b> SVM</a></li>
<li class="chapter" data-level="13.3.8" data-path="frameworks.html"><a href="frameworks.html#model-selection-1"><i class="fa fa-check"></i><b>13.3.8</b> Model Selection</a></li>
<li class="chapter" data-level="13.3.9" data-path="frameworks.html"><a href="frameworks.html#stacking"><i class="fa fa-check"></i><b>13.3.9</b> Stacking</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="frameworks.html"><a href="frameworks.html#data-table"><i class="fa fa-check"></i><b>13.4</b> Data Table</a></li>
<li class="chapter" data-level="13.5" data-path="frameworks.html"><a href="frameworks.html#keras"><i class="fa fa-check"></i><b>13.5</b> Keras</a><ul>
<li class="chapter" data-level="13.5.1" data-path="frameworks.html"><a href="frameworks.html#regression"><i class="fa fa-check"></i><b>13.5.1</b> Regression</a></li>
<li class="chapter" data-level="13.5.2" data-path="frameworks.html"><a href="frameworks.html#classification"><i class="fa fa-check"></i><b>13.5.2</b> Classification</a></li>
<li class="chapter" data-level="13.5.3" data-path="frameworks.html"><a href="frameworks.html#more"><i class="fa fa-check"></i><b>13.5.3</b> More</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>14</b> Resources</a><ul>
<li class="chapter" data-level="14.1" data-path="resources.html"><a href="resources.html#general-6"><i class="fa fa-check"></i><b>14.1</b> General</a></li>
<li class="chapter" data-level="14.2" data-path="resources.html"><a href="resources.html#auto-data-science"><i class="fa fa-check"></i><b>14.2</b> Auto Data Science</a></li>
<li class="chapter" data-level="14.3" data-path="resources.html"><a href="resources.html#data"><i class="fa fa-check"></i><b>14.3</b> Data</a></li>
<li class="chapter" data-level="14.4" data-path="resources.html"><a href="resources.html#import-2"><i class="fa fa-check"></i><b>14.4</b> Import</a></li>
<li class="chapter" data-level="14.5" data-path="resources.html"><a href="resources.html#tidytransform"><i class="fa fa-check"></i><b>14.5</b> Tidy/Transform</a></li>
<li class="chapter" data-level="14.6" data-path="resources.html"><a href="resources.html#visualize-2"><i class="fa fa-check"></i><b>14.6</b> Visualize</a></li>
<li class="chapter" data-level="14.7" data-path="resources.html"><a href="resources.html#model-2"><i class="fa fa-check"></i><b>14.7</b> Model</a><ul>
<li class="chapter" data-level="14.7.1" data-path="resources.html"><a href="resources.html#general-7"><i class="fa fa-check"></i><b>14.7.1</b> General</a></li>
<li class="chapter" data-level="14.7.2" data-path="resources.html"><a href="resources.html#supervised-1"><i class="fa fa-check"></i><b>14.7.2</b> Supervised</a></li>
<li class="chapter" data-level="14.7.3" data-path="resources.html"><a href="resources.html#unsupervised"><i class="fa fa-check"></i><b>14.7.3</b> Unsupervised</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="resources.html"><a href="resources.html#other-ml"><i class="fa fa-check"></i><b>14.8</b> Other ML</a><ul>
<li class="chapter" data-level="14.8.1" data-path="resources.html"><a href="resources.html#deep-learning-1"><i class="fa fa-check"></i><b>14.8.1</b> Deep Learning</a></li>
<li class="chapter" data-level="14.8.2" data-path="resources.html"><a href="resources.html#probabilistic-programming-1"><i class="fa fa-check"></i><b>14.8.2</b> Probabilistic Programming</a></li>
<li class="chapter" data-level="14.8.3" data-path="resources.html"><a href="resources.html#causality"><i class="fa fa-check"></i><b>14.8.3</b> Causality</a></li>
<li class="chapter" data-level="14.8.4" data-path="resources.html"><a href="resources.html#nlp"><i class="fa fa-check"></i><b>14.8.4</b> NLP</a></li>
<li class="chapter" data-level="14.8.5" data-path="resources.html"><a href="resources.html#computer-vision"><i class="fa fa-check"></i><b>14.8.5</b> Computer Vision</a></li>
<li class="chapter" data-level="14.8.6" data-path="resources.html"><a href="resources.html#geospatial"><i class="fa fa-check"></i><b>14.8.6</b> Geospatial</a></li>
<li class="chapter" data-level="14.8.7" data-path="resources.html"><a href="resources.html#networks"><i class="fa fa-check"></i><b>14.8.7</b> Networks</a></li>
<li class="chapter" data-level="14.8.8" data-path="resources.html"><a href="resources.html#ai"><i class="fa fa-check"></i><b>14.8.8</b> AI</a></li>
<li class="chapter" data-level="14.8.9" data-path="resources.html"><a href="resources.html#rl"><i class="fa fa-check"></i><b>14.8.9</b> RL</a></li>
<li class="chapter" data-level="14.8.10" data-path="resources.html"><a href="resources.html#genetic-algorithms-es"><i class="fa fa-check"></i><b>14.8.10</b> Genetic Algorithms / ES</a></li>
<li class="chapter" data-level="14.8.11" data-path="resources.html"><a href="resources.html#time-series-1"><i class="fa fa-check"></i><b>14.8.11</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="resources.html"><a href="resources.html#communicate-2"><i class="fa fa-check"></i><b>14.9</b> Communicate</a></li>
<li class="chapter" data-level="14.10" data-path="resources.html"><a href="resources.html#deploy-maintain"><i class="fa fa-check"></i><b>14.10</b> Deploy &amp; Maintain</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Cribsheet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="frameworks" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> Frameworks</h1>
<div id="pyspark" class="section level2">
<h2><span class="header-section-number">13.1</span> PySpark</h2>
<p>A [cheatsheet[(<a href="https://www.qubole.com/resources/pyspark-cheatsheet/" class="uri">https://www.qubole.com/resources/pyspark-cheatsheet/</a>).</p>
<p>Setup</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> findspark
findspark.init()
<span class="im">import</span> pyspark
<span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession
sc <span class="op">=</span> pyspark.SparkContext()
spark <span class="op">=</span> SparkSession.builder.appName(<span class="st">&#39;example&#39;</span>).getOrCreate()
<span class="im">import</span> findspark
findspark.init()
<span class="im">import</span> pyspark
<span class="im">import</span> random
sc <span class="op">=</span> pyspark.SparkContext(appName<span class="op">=</span><span class="st">&quot;Pi&quot;</span>)
num_samples <span class="op">=</span> <span class="dv">100000000</span>
<span class="kw">def</span> inside(p):     
    x, y <span class="op">=</span> random.random(), random.random()
    <span class="cf">return</span> x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y <span class="op">&lt;</span> <span class="dv">1</span>
count <span class="op">=</span> sc.parallelize(<span class="bu">range</span>(<span class="dv">0</span>, num_samples)).<span class="bu">filter</span>(inside).count()
pi <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> count <span class="op">/</span> num_samples
<span class="bu">print</span>(pi)
sc.stop()</code></pre></div>
<p>Libs</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> pyspark.ml.feature <span class="im">import</span> StringIndexer, OneHotEncoder, VectorAssembler
<span class="im">from</span> pyspark.ml <span class="im">import</span> Pipeline
<span class="im">from</span> pyspark.ml.classification <span class="im">import</span> LogisticRegression
<span class="im">import</span> pyspark.ml.evaluation <span class="im">as</span> evals
<span class="im">import</span> pyspark.ml.tuning <span class="im">as</span> tune
<span class="im">import</span> numpy <span class="im">as</span> np
df <span class="op">=</span> spark.read.csv(<span class="st">&#39;data.csv&#39;</span>, header <span class="op">=</span> <span class="va">True</span>)
df.show(<span class="dv">5</span>)
df.columns</code></pre></div>
<p>Preprocessing</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">df <span class="op">=</span> df.withColumn(<span class="st">&quot;label&quot;</span>, df[<span class="st">&quot;target&quot;</span>].cast(<span class="st">&#39;integer&#39;</span>))
scf_indexer <span class="op">=</span> StringIndexer(inputCol <span class="op">=</span> <span class="st">&quot;some_cat_feature&quot;</span>, outputCol <span class="op">=</span> <span class="st">&quot;some_cat_feature_index&quot;</span>)
scf_encoder <span class="op">=</span> OneHotEncoder(inputCol <span class="op">=</span> <span class="st">&quot;some_cat_feature_index&quot;</span>, outputCol <span class="op">=</span> <span class="st">&quot;some_cat_feature_fact&quot;</span>)
feature_cols <span class="op">=</span> [<span class="st">&quot;some list of column names&quot;</span>]
vec_assembler <span class="op">=</span> VectorAssembler(inputCols <span class="op">=</span> feature_cols, 
                                outputCol <span class="op">=</span> <span class="st">&quot;features&quot;</span>)
pipe <span class="op">=</span> Pipeline(stages <span class="op">=</span> [scf_indexer, scf_encoder, vec_assembler])
piped_data <span class="op">=</span> pipe.fit(df).transform(df)
training, test <span class="op">=</span> piped_data.randomSplit([.<span class="dv">8</span>, .<span class="dv">2</span>])</code></pre></div>
<p>Model</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">clf_lr <span class="op">=</span> LogisticRegression()
evaluator <span class="op">=</span> evals.BinaryClassificationEvaluator(metricName <span class="op">=</span> <span class="st">&quot;areaUnderROC&quot;</span>)
grid <span class="op">=</span> tune.ParamGridBuilder()
grid <span class="op">=</span> grid.addGrid(clf_lr.regParam, np.arange(<span class="dv">0</span>, .<span class="dv">1</span>, .<span class="dv">01</span>))
grid <span class="op">=</span> grid.addGrid(clf_lr.elasticNetParam, [<span class="dv">0</span>, <span class="dv">1</span>])
grid <span class="op">=</span> grid.build()
clf_lr_cv <span class="op">=</span> tune.CrossValidator(
    estimator <span class="op">=</span> clf_lr,
    estimatorParamMaps <span class="op">=</span> grid,
    evaluator <span class="op">=</span> evaluator,
    numFolds <span class="op">=</span> <span class="dv">5</span>
               )
best_clf_lr <span class="op">=</span> clf_lr_cv.fit(training).bestModel
results <span class="op">=</span> best_clf_lr.transform(training)
<span class="bu">print</span>(evaluator.evaluate(results))
<span class="co">#stop</span>
sc.stop()</code></pre></div>
<p>Quick Test:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> findspark
findspark.init()
<span class="im">import</span> pyspark
<span class="im">import</span> random
sc <span class="op">=</span> pyspark.SparkContext(appName<span class="op">=</span><span class="st">&quot;Pi&quot;</span>)
num_samples <span class="op">=</span> <span class="dv">100000000</span>
<span class="kw">def</span> inside(p):     
    x, y <span class="op">=</span> random.random(), random.random()
    <span class="cf">return</span> x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y <span class="op">&lt;</span> <span class="dv">1</span>
count <span class="op">=</span> sc.parallelize(<span class="bu">range</span>(<span class="dv">0</span>, num_samples)).<span class="bu">filter</span>(inside).count()
pi <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> count <span class="op">/</span> num_samples
<span class="bu">print</span>(pi)
sc.stop()</code></pre></div>
<p>First have to create a SparkSession object from your SparkContext. The SparkContext is ther connection to the cluster and the SparkSession as your interface with that connection.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pyspark
<span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession
sc <span class="op">=</span> pyspark.SparkContext()
spark <span class="op">=</span> SparkSession.builder.getOrCreate() <span class="co"># SparkSession.builder.appName(&#39;chosenName&#39;).getOrCreate()</span></code></pre></div>
<p>The rest of my notes:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">## List tables</span>
spark.catalog.listTables()
<span class="co">## Access and display data</span>
query <span class="op">=</span> <span class="st">&quot;FROM flights SELECT * LIMIT 10&quot;</span>
flights10 <span class="op">=</span> spark.sql(query)
flights10.show()
<span class="co">## Cast</span>
df[<span class="st">&#39;g&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;g&#39;</span>].astype(<span class="bu">str</span>)
<span class="co">## Read from csv</span>
df<span class="op">=</span> spark.read.csv(file_path, header <span class="op">=</span> <span class="va">True</span>)
df <span class="op">=</span> spark.read.csv(<span class="st">&#39;fileNameWithPath&#39;</span>, mode<span class="op">=</span><span class="st">&quot;DROPMALFORMED&quot;</span>,inferSchema<span class="op">=</span><span class="va">True</span>, header <span class="op">=</span> <span class="va">True</span>)
df <span class="op">=</span> spark.read.<span class="bu">format</span>(<span class="st">&quot;csv&quot;</span>).option(<span class="st">&quot;header&quot;</span>,<span class="st">&quot;true&quot;</span>).option(<span class="st">&quot;inferSchema&quot;</span>,<span class="st">&quot;true&quot;</span>).load(<span class="st">&quot;john_doe.csv&quot;</span>)
<span class="co">## Spark df to pandas and vice versa</span>
toPandas()
spark_temp <span class="op">=</span> spark.createDataFrame(pd_temp)
<span class="co">## Add to the catalog</span>
spark_temp.createOrReplaceTempView(<span class="st">&quot;temp&quot;</span>)
<span class="co">## Mutate</span>
df <span class="op">=</span> df.withColumn(<span class="st">&quot;newCol&quot;</span>, df.oldCol <span class="op">+</span> <span class="dv">1</span>)
model_data <span class="op">=</span> model_data.withColumn(<span class="st">&quot;arr_delay&quot;</span>, model_data.arr_delay.cast(<span class="st">&#39;integer&#39;</span>))
model_data <span class="op">=</span> model_data.withColumn(<span class="st">&quot;plane_age&quot;</span>, model_data.year <span class="op">-</span> model_data.plane_year)
<span class="co">## Create the DataFrame flights</span>
flights <span class="op">=</span> spark.table(<span class="st">&#39;flights&#39;</span>)
<span class="co">## Get column names</span>
spark_df.schema.names
spark_df.printSchema()
<span class="co">## Filter: takes either a Spark Column of boolean (True/False) values or the WHERE clause of a SQL expression as a string</span>
long_flights1 <span class="op">=</span> flights.<span class="bu">filter</span>(<span class="st">&#39;distance &gt; 1000&#39;</span>)
long_flights2 <span class="op">=</span> flights.<span class="bu">filter</span>(flights.distance <span class="op">&gt;</span> <span class="dv">1000</span>)
model_data <span class="op">=</span> model_data.<span class="bu">filter</span>(<span class="st">&quot;arr_delay is not NULL and dep_delay is not NULL and air_time is not NULL and plane_year is not NULL&quot;</span>)
<span class="co">## Groupby examples</span>
flights.<span class="bu">filter</span>(flights.origin <span class="op">==</span> <span class="st">&quot;PDX&quot;</span>).groupBy().<span class="bu">min</span>(<span class="st">&quot;distance&quot;</span>).show()
flights.<span class="bu">filter</span>(flights.carrier<span class="op">==</span><span class="st">&#39;DL&#39;</span>).<span class="bu">filter</span>(flights.origin<span class="op">==</span><span class="st">&#39;SEA&#39;</span>).groupBy().avg(<span class="st">&#39;air_time&#39;</span>).show()
flights.withColumn(<span class="st">&quot;duration_hrs&quot;</span>, flights.air_time<span class="op">/</span><span class="dv">60</span>).groupBy().<span class="bu">sum</span>(<span class="st">&#39;duration_hrs&#39;</span>).show()
<span class="co">## Spark functions</span>
<span class="im">import</span> pyspark.sql.functions <span class="im">as</span> F
by_month_dest.agg(F.stddev(<span class="st">&#39;dep_delay&#39;</span>)).show()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">## Drop column</span>
final_test_data.drop(<span class="st">&#39;State&#39;</span>)
<span class="co">## Dummying</span>
<span class="co">#The first step to encoding your categorical feature is to create a StringIndexer. Members of this class are #Estimators that take a DataFrame with a column of strings and map each unique string to a number. Then, the #Estimator returns a Transformer that takes a DataFrame, attaches the mapping to it as metadata, and returns a #new DataFrame with a numeric column corresponding to the string column.</span>
<span class="co">#The second step is to encode this numeric column as a one-hot vector using a OneHotEncoder. This works exactly #the same way as the StringIndexer by creating an Estimator and then a Transformer</span>
<span class="co">## Create a StringIndexer</span>
carr_indexer <span class="op">=</span> StringIndexer(inputCol<span class="op">=</span><span class="st">&quot;carrier&quot;</span>, outputCol<span class="op">=</span><span class="st">&quot;carrier_index&quot;</span>)
<span class="co">## Create a OneHotEncoder</span>
carr_encoder <span class="op">=</span> OneHotEncoder(inputCol<span class="op">=</span><span class="st">&quot;carrier_index&quot;</span>, outputCol<span class="op">=</span><span class="st">&quot;carrier_fact&quot;</span>)
<span class="co">## Make a VectorAssembler</span>
vec_assembler <span class="op">=</span> VectorAssembler(inputCols<span class="op">=</span>[<span class="st">&quot;month&quot;</span>, <span class="st">&quot;air_time&quot;</span>, <span class="st">&quot;carrier_fact&quot;</span>, <span class="st">&quot;dest_fact&quot;</span>, <span class="st">&quot;plane_age&quot;</span>], outputCol<span class="op">=</span><span class="st">&quot;features&quot;</span>)
<span class="co">## Import &amp; Make Pipeline</span>
<span class="im">from</span> pyspark.ml <span class="im">import</span> Pipeline
flights_pipe <span class="op">=</span> Pipeline(stages<span class="op">=</span>[dest_indexer, dest_encoder, carr_indexer, carr_encoder, vec_assembler])
<span class="co">## Fit and transform the data</span>
piped_data <span class="op">=</span> flights_pipe.fit(model_data).transform(model_data)
<span class="co">## Train-test split</span>
training, test <span class="op">=</span> piped_data.randomSplit([.<span class="dv">6</span>, .<span class="dv">4</span>])
<span class="co">## Tuning &amp; Selection</span>
<span class="co">## Import LogisticRegression</span>
<span class="im">from</span> pyspark.ml.classification <span class="im">import</span> LogisticRegression
<span class="co">## Create a LogisticRegression Estimator</span>
lr <span class="op">=</span> LogisticRegression()
<span class="co">## Import the evaluation submodule</span>
<span class="im">import</span> pyspark.ml.evaluation <span class="im">as</span> evals
<span class="co">## Create a BinaryClassificationEvaluator</span>
evaluator <span class="op">=</span> evals.BinaryClassificationEvaluator(metricName<span class="op">=</span><span class="st">&quot;areaUnderROC&quot;</span>)
<span class="co">## Import the tuning submodule</span>
<span class="im">import</span> pyspark.ml.tuning <span class="im">as</span> tune
<span class="co">## Create the parameter grid</span>
grid <span class="op">=</span> tune.ParamGridBuilder()
<span class="co">## Add the hyperparameter</span>
grid <span class="op">=</span> grid.addGrid(lr.regParam, np.arange(<span class="dv">0</span>, .<span class="dv">1</span>, .<span class="dv">01</span>))
grid <span class="op">=</span> grid.addGrid(lr.elasticNetParam, [<span class="dv">0</span>, <span class="dv">1</span>])
<span class="co">## Build the grid</span>
grid <span class="op">=</span> grid.build()
<span class="co">## Create the CrossValidator</span>
cv <span class="op">=</span> tune.CrossValidator(
estimator<span class="op">=</span>lr,
estimatorParamMaps<span class="op">=</span>grid,
evaluator<span class="op">=</span>evaluator
               )
<span class="co">## Fit cross validation models</span>
models <span class="op">=</span> cv.fit(training)
<span class="co">## Extract the best model</span>
best_lr <span class="op">=</span> models.bestModel
<span class="co">## Use the model to predict the test set</span>
test_results <span class="op">=</span> best_lr.transform(test)
<span class="co">## Evaluate the predictions</span>
<span class="bu">print</span>(evaluator.evaluate(test_results))</code></pre></div>
<ul>
<li><p>Spark’s assumes the target is called ‘label’ in ML. Everything else is a feature.</p></li>
<li><p>alias() method to rename a column you’re selecting.</p></li>
<li><p>cast() method: nominative determinism on columns</p></li>
<li><p>withColumn(): create new column</p></li>
<li><p>pyspark.ml.feature</p></li>
<li><p>At the core of the pyspark.ml module are the Transformer and Estimator classes. Transformer classes are used for pre-processing and have a .transform() method. eg. PCA</p></li>
<li><p>You can create what are called ‘one-hot vectors’ to represent the carrier and the destination of each flight. A one-hot vector is a way of representing a categorical feature where every observation has a vector in which all elements are zero except for at most one element, which has a value of one (1).</p></li>
<li><p>Estimator classes are for modeling and all implement a .fit() method. eg. StringIndexerModel for including categorical data saved as strings in your models</p></li>
<li><p>selectExpr() takes SQL expressions as a string</p></li>
<li><p>show() vs collect()</p></li>
<li><p>Spark only handles numeric data</p></li>
<li><p>In Spark it’s important to make sure you split the data after all the transformations. This is because operations like StringIndexer don’t always produce the same index even when given the same list of strings.</p></li>
</ul>
</div>
<div id="sparklyr" class="section level2">
<h2><span class="header-section-number">13.2</span> Sparklyr</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sparklyr)

sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master=</span><span class="st">&quot;local&quot;</span>)
config &lt;-<span class="st"> </span><span class="kw">spark_config</span>()
config<span class="op">$</span>spark.executor.cores &lt;-<span class="st"> </span><span class="dv">8</span>
config<span class="op">$</span>spark.executor.memory &lt;-<span class="st"> &quot;25G&quot;</span>

flights &lt;-<span class="st"> </span><span class="kw">copy_to</span>(sc, flights, <span class="st">&quot;flights&quot;</span>)
<span class="kw">src_tbls</span>(sc)

iris_tbl <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spark_apply</span>(
    <span class="cf">function</span>(e) <span class="kw">summary</span>(<span class="kw">lm</span>(Petal_Length <span class="op">~</span><span class="st"> </span>Petal_Width, e))<span class="op">$</span>r.squared,
    <span class="dt">names =</span> <span class="st">&quot;r.squared&quot;</span>,
    <span class="dt">group_by =</span> <span class="st">&quot;Species&quot;</span>)


<span class="kw">spark_disconnect</span>(sc)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sparklyr)

## Connect to your Spark cluster
spark_conn &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>)

## Print the version of Spark
<span class="kw">spark_version</span>(<span class="dt">sc =</span> spark_conn)

## Disconnect from Spark
<span class="kw">spark_disconnect</span>(<span class="dt">sc =</span> spark_conn)

## See tables
<span class="kw">src_tbls</span>(sc)

## Copy track_metadata to Spark
track_metadata_tbl &lt;-<span class="st"> </span><span class="kw">copy_to</span>(spark_conn, track_metadata)

## Print 5 rows, all columns
<span class="kw">print</span>(track_metadata_tbl, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">width =</span> <span class="ot">Inf</span>)

## Write and run SQL query
query &lt;-<span class="st"> &quot;SELECT * FROM track_metadata WHERE year &lt; 1935 AND duration &gt; 300&quot;</span>
(results &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(spark_conn, query))

## General transformation structure and example
a_tibble <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ft_some_transformation</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, some_other_args)

hotttnesss &lt;-<span class="st"> </span>track_metadata_tbl <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Select artist_hotttnesss</span>
<span class="st">  </span><span class="kw">select</span>(artist_hotttnesss) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Binarize to is_hottt_or_nottt</span>
<span class="st">  </span><span class="kw">ft_binarizer</span>(<span class="st">&#39;artist_hotttnesss&#39;</span>, <span class="st">&#39;is_hottt_or_nottt&#39;</span>, <span class="dt">threshold =</span> .<span class="dv">5</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Collect the result</span>
<span class="st">  </span><span class="kw">collect</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Convert is_hottt_or_nottt to logical</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">is_hottt_or_nottt =</span> <span class="kw">as.logical</span>(is_hottt_or_nottt))
  
## Get and transform the schema

(schema &lt;-<span class="st"> </span><span class="kw">sdf_schema</span>(track_metadata_tbl))
schema <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">lapply</span>(<span class="cf">function</span>(x) <span class="kw">do.call</span>(data_frame, x)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">bind_rows</span>()

## Train-test split
partitioned &lt;-<span class="st"> </span>track_metadata_tbl <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sdf_partition</span>(<span class="dt">training =</span> <span class="fl">0.7</span>, <span class="dt">testing =</span> <span class="fl">0.3</span>)

## List ml functions
<span class="kw">ls</span>(<span class="st">&quot;package:sparklyr&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;^ml&quot;</span>)

## GBT Example

gradient_boosted_trees_model &lt;-<span class="st"> </span>track_data_to_model_tbl <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Run the gradient boosted trees model</span>
<span class="st">   </span><span class="kw">ml_gradient_boosted_trees</span>(<span class="st">&#39;year&#39;</span>, feature_colnames)

responses &lt;-<span class="st"> </span>track_data_to_predict_tbl <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Select the year column</span>
<span class="st">  </span><span class="kw">select</span>(year) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Collect the results</span>
<span class="st">  </span><span class="kw">collect</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Add in the predictions</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">predicted_year =</span> <span class="kw">predict</span>(
      gradient_boosted_trees_model,
      track_data_to_predict_tbl
    )
  )</code></pre></div>
<p><strong>Parquet Aside</strong></p>
<p>Parquet files are quicker to read and write. parquet files can be used with other tools in the Hadoop ecosystem, like Shark, Impala, Hive, and Pig.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## The parquet_dir has been pre-defined
parquet_dir

## List the files in the parquet dir
filenames &lt;-<span class="st"> </span><span class="kw">dir</span>(parquet_dir, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)

## Show the filenames and their sizes
<span class="kw">data_frame</span>(
  <span class="dt">filename =</span> <span class="kw">basename</span>(filenames),
  <span class="dt">size_bytes =</span> <span class="kw">file.size</span>(filenames)
)

<span class="co">#Import the data into Spark</span>

timbre_tbl &lt;-<span class="st"> </span><span class="kw">spark_read_parquet</span>(spark_conn, <span class="st">&#39;timbre&#39;</span>, parquet_dir)</code></pre></div>
<ul>
<li><p>To collect your data: that is, to move it from Spark to R, you call collect(). copy_to() moves your data from R to Spark.</p></li>
<li><p>Use compute() to compute the calculation, but store the results in a temporary data frame on Spark.</p></li>
<li><p>If you want to delay returning the data, you can use dbSendQuery() to execute the query, then dbFetch() to return the results.</p></li>
<li><p>feature transforms: ft_, ml functions: ml_, spark df functions: sdf_</p></li>
<li><p>ft_tokenizer(): to lower and split into individual words, ft_regex_tokenizer, sdf_sort</p></li>
</ul>
</div>
<div id="caret" class="section level2">
<h2><span class="header-section-number">13.3</span> Caret</h2>
<p>attributes(clf_lr): results, finalModel</p>
<div id="preprocessing" class="section level3">
<h3><span class="header-section-number">13.3.1</span> Preprocessing</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Apply median imputation: model</span>
model &lt;-<span class="st"> </span><span class="kw">train</span>(
  <span class="dt">x =</span> breast_cancer_x, 
  <span class="dt">y =</span> breast_cancer_y,
  <span class="dt">method =</span> <span class="st">&#39;glm&#39;</span>,
  <span class="dt">trControl =</span> myControl,
  <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&#39;medianImpute&#39;</span>, <span class="st">&quot;knnImpute&quot;</span>, <span class="st">&#39;center&#39;</span>, <span class="st">&#39;scale&#39;</span>, <span class="st">&#39;pca&#39;</span>)
)

<span class="kw">dotplot</span>(resamples, <span class="dt">metric =</span> <span class="st">&quot;ROC&quot;</span>)

<span class="kw">min</span>(model<span class="op">$</span>results<span class="op">$</span>RSME)

<span class="co"># Identify near zero variance predictors: remove_cols</span>
remove_cols &lt;-<span class="st"> </span><span class="kw">nearZeroVar</span>(bloodbrain_x, <span class="dt">names =</span> <span class="ot">TRUE</span>, 
                           <span class="dt">freqCut =</span> <span class="dv">2</span>, <span class="dt">uniqueCut =</span> <span class="dv">20</span>)

<span class="co"># Get all column names from bloodbrain_x: all_cols</span>
all_cols =<span class="st"> </span><span class="kw">colnames</span>(bloodbrain_x)

<span class="co"># Remove from data: bloodbrain_x_small</span>
bloodbrain_x_small &lt;-<span class="st"> </span>bloodbrain_x[ , <span class="kw">setdiff</span>(all_cols, remove_cols)]</code></pre></div>
</div>
<div id="lm" class="section level3">
<h3><span class="header-section-number">13.3.2</span> LM</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set seed</span>
<span class="kw">set.seed</span>(<span class="dv">42</span>)

<span class="co"># Fit lm model: model</span>
model &lt;-<span class="st"> </span><span class="kw">lm</span>(price <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> diamonds)

<span class="co"># Predict on full data: p</span>
p &lt;-<span class="st"> </span><span class="kw">predict</span>(model, diamonds)

<span class="co"># Compute errors: error</span>
error &lt;-<span class="st"> </span>p <span class="op">-</span><span class="st"> </span>diamonds<span class="op">$</span>price

<span class="co"># Calculate RMSE</span>
<span class="kw">sqrt</span>(<span class="kw">mean</span>(error<span class="op">^</span><span class="dv">2</span>))

<span class="co"># Fit lm model using 5 x 5-fold CV: model</span>
model &lt;-<span class="st"> </span><span class="kw">train</span>(
  medv <span class="op">~</span><span class="st"> </span>., 
  Boston,
  <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,
  <span class="dt">trControl =</span> <span class="kw">trainControl</span>(
    <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">5</span>,
    <span class="dt">repeats =</span> <span class="dv">5</span>, <span class="dt">verboseIter =</span> <span class="ot">TRUE</span>
  )
)</code></pre></div>
</div>
<div id="lassoridge" class="section level3">
<h3><span class="header-section-number">13.3.3</span> Lasso/Ridge</h3>
<p>Alpha controls balance between lasso and ridge. Lambda controls penalty.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit glmnet model: model</span>
model &lt;-<span class="st"> </span><span class="kw">train</span>(
  y<span class="op">~</span>., <span class="dt">data =</span> overfit,
  <span class="dt">method =</span> <span class="st">&quot;glmnet&quot;</span>,
  <span class="dt">trControl =</span> myControl
)

<span class="co"># Train glmnet with custom trainControl and tuning: model</span>
model &lt;-<span class="st"> </span><span class="kw">train</span>(
  y<span class="op">~</span>., overfit,
  <span class="dt">tuneGrid =</span> <span class="kw">expand.grid</span>(<span class="dt">alpha =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">lambda =</span> <span class="kw">seq</span>(<span class="fl">0.0001</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">20</span>)),
  <span class="dt">method =</span> <span class="st">&#39;glmnet&#39;</span>,
  <span class="dt">trControl =</span> myControl
)

<span class="co"># Print model to console</span>
model

<span class="co"># Print maximum ROC statistic</span>
<span class="kw">max</span>(model[[<span class="st">&quot;results&quot;</span>]][[<span class="st">&quot;ROC&quot;</span>]])</code></pre></div>
</div>
<div id="logistic-regression-1" class="section level3">
<h3><span class="header-section-number">13.3.4</span> Logistic Regression</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit glm model</span>
model =<span class="st"> </span><span class="kw">glm</span>(Class <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, train)

<span class="co"># Predict on test: p</span>
p =<span class="st"> </span><span class="kw">predict</span>(model, test, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)

<span class="co"># Calculate class probabilities: p_class</span>
p_class &lt;-<span class="st"> </span><span class="kw">ifelse</span>(p <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.50</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;R&quot;</span>)

<span class="co"># Create confusion matrix</span>
<span class="kw">confusionMatrix</span>(p_class, test<span class="op">$</span>Class)</code></pre></div>
</div>
<div id="train-test-split-folds-cv" class="section level3">
<h3><span class="header-section-number">13.3.5</span> Train-Test Split, Folds, &amp; CV</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Shuffle row indices: rows</span>
rows =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(Sonar))

<span class="co"># Randomly order data: Sonar</span>
Sonar =<span class="st"> </span>Sonar[rows,]

<span class="co"># Identify row to split on: split</span>
split &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">nrow</span>(Sonar) <span class="op">*</span><span class="st"> </span>.<span class="dv">6</span>)

<span class="co"># Create train: 60%</span>
train =<span class="st"> </span>Sonar[<span class="dv">1</span><span class="op">:</span>split,]

<span class="co"># Create test: 40%</span>
test =<span class="st"> </span>Sonar[(split<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">nrow</span>(Sonar),]

<span class="co"># Create custom indices: myFolds</span>
myFolds &lt;-<span class="st"> </span><span class="kw">createFolds</span>(churn_y, <span class="dt">k =</span> <span class="dv">5</span>)

<span class="co"># Create reusable trainControl object: myControl</span>
myControl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(
  <span class="dt">summaryFunction =</span> twoClassSummary, <span class="co">#default option is default summary</span>
  <span class="dt">classProbs =</span> <span class="ot">TRUE</span>, <span class="co"># IMPORTANT!</span>
  <span class="dt">verboseIter =</span> <span class="ot">TRUE</span>,
  <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>,
  <span class="dt">index =</span> myFolds
)</code></pre></div>
</div>
<div id="random-forest-1" class="section level3">
<h3><span class="header-section-number">13.3.6</span> Random Forest</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit random forest: model</span>
model &lt;-<span class="st"> </span><span class="kw">train</span>(
  quality<span class="op">~</span>.,
  <span class="dt">tuneLength =</span> <span class="dv">3</span>,
  <span class="co">#tuneGrid = data.frame(mtry = c(2, 3, 7)),</span>
  <span class="dt">data =</span> wine, 
  <span class="dt">method =</span> <span class="st">&#39;ranger&#39;</span>,
  <span class="dt">trControl =</span> <span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">5</span>, <span class="dt">verboseIter =</span> <span class="ot">TRUE</span>)
)

<span class="co"># Print model to console</span>
model

<span class="co"># Plot model</span>
<span class="kw">plot</span>(model)</code></pre></div>
</div>
<div id="svm-1" class="section level3">
<h3><span class="header-section-number">13.3.7</span> SVM</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clf_svm &lt;-<span class="st"> </span><span class="kw">train</span>(
  pass <span class="op">~</span>., 
  <span class="dt">data =</span> df3, 
  <span class="dt">method =</span> <span class="st">&quot;svmLinear&quot;</span>,
  <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>)
                 )</code></pre></div>
</div>
<div id="model-selection-1" class="section level3">
<h3><span class="header-section-number">13.3.8</span> Model Selection</h3>
<p>Now that you have fit two models to the churn dataset, it’s time to compare their out-of-sample predictions and choose which one is the best model for your dataset.</p>
<p>You can compare models in caret using the resamples() function, provided they have the same training data and use the same trainControl object with preset cross-validation folds. resamples() takes as input a list of models and can be used to compare dozens of models at once (though in this case you are only comparing two models).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create model_list</span>
model_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">item1 =</span> model_glmnet, <span class="dt">item2 =</span> model_rf)

<span class="co"># Pass model_list to resamples(): resamples</span>
resamples =<span class="st"> </span><span class="kw">resamples</span>(model_list)

<span class="co"># Summarize the results</span>
<span class="kw">summary</span>(resamples)

<span class="co"># Create bwplot</span>
<span class="kw">bwplot</span>(resamples, <span class="dt">metric =</span> <span class="st">&#39;ROC&#39;</span>)

<span class="co"># Create xyplot</span>
<span class="kw">xyplot</span>(resamples)

<span class="co"># Predict on test: p</span>
p =<span class="st"> </span><span class="kw">predict</span>(model, test, <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>)

<span class="co"># Make ROC curve</span>
<span class="kw">colAUC</span>(p, test<span class="op">$</span>Class, <span class="dt">plotROC =</span> <span class="ot">TRUE</span>)</code></pre></div>
<ul>
<li>caret: finalModel of model object</li>
</ul>
</div>
<div id="stacking" class="section level3">
<h3><span class="header-section-number">13.3.9</span> Stacking</h3>
<p>caretEnsemble provides the caretList() function for creating multiple caret models at once on the same dataset, using the same resampling folds. You can also create your own lists of caret models. Use the caretStack() function to make a stack of caret models, with the two sub-models (glmnet and ranger) feeding into another (hopefully more accurate!) caret model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create ensemble model: stack</span>
stack &lt;-<span class="st"> </span><span class="kw">caretStack</span>(model_list, <span class="dt">method =</span> <span class="st">&#39;glm&#39;</span>)

<span class="co"># Look at summary</span>
<span class="kw">summary</span>(stack)</code></pre></div>
<p>&amp; caretEnnsemble</p>
</div>
</div>
<div id="data-table" class="section level2">
<h2><span class="header-section-number">13.4</span> Data Table</h2>
<ul>
<li><p>Operations done by reference</p></li>
<li><p>dt[i, j, by] : subset by i calculate by j grouped using by</p></li>
<li><p>1: numeric | 1L: integer</p></li>
<li><p>NA_integer_: integer</p></li>
<li><p>DT[.N] : prints last row</p></li>
<li><p>names(DT): colnames</p></li>
<li><p>dim(DT): dimensions</p></li>
<li><p>DT[, .(A, B)]: returns two columns</p></li>
<li><p>DT[, c(A, B)]: returns a concatenated vector</p></li>
<li><p>DT[, .(sum_c = sum(C)]</p></li>
<li><p>DT[, plot(A, C)]</p></li>
<li><p>DT[, A:=NULL]: Remove column A</p></li>
<li><p>DT[, .(sumB = sum(B)), by = .(Grp = A%%2)]</p></li>
<li><p>DT[, .N, by = Sepal.Width]: .N is the count of each group</p></li>
<li><p>DT[, lapply(.SD, median)]: .SD is a placeholder for all the columns</p></li>
<li><p>dogs[, lapply(.SD, mean), .SDcols = 2:3]: Find mean of columns 2 &amp; 3</p></li>
<li><p>for (i in 1:5) set(DT, i, 3L, i+1): update first 5 rows of 3rd column</p></li>
<li><p>setnames(DT, ‘y’, ‘z’): changes colname from y to z</p></li>
<li><p>setkey(DT, A, B)</p></li>
<li><p>DT[.(‘b’)]</p></li>
<li><p>DT[.(c(‘b’, ‘c’))]</p></li>
<li><p>DT[.(c(‘b’, ‘c’)), mult=“first”]</p></li>
<li><p>DT[c(“b”, “c”), .SD[c(1, .N)], by = .EACHI]: First and last row of the “b” and “c” groups</p></li>
<li><p>DT[c(“b”, “c”), { print(.SD); .SD[c(1, .N)] }, by = .EACHI]</p></li>
<li><p>roll=TRUE, ‘nearest’, -Inf, Inf | rollends=FALSE</p></li>
</ul>
</div>
<div id="keras" class="section level2">
<h2><span class="header-section-number">13.5</span> Keras</h2>
<p>Here’s a <a href="https://github.com/fastforwardlabs/keras-hello-world/blob/master/kerashelloworld.ipynb">Hello World</a> and the general framework:</p>
<ul>
<li><p>declare: sequential</p></li>
<li><p>add layers input-hidden-output</p></li>
<li><p>compile</p></li>
<li><p>fit</p></li>
</ul>
<p>Keras only uses numpy arrays.</p>
<div id="regression" class="section level3">
<h3><span class="header-section-number">13.5.1</span> Regression</h3>
<ul>
<li><p>loss = mean_squared_error</p></li>
<li><p>metric: rmse</p></li>
<li><p>activation_function = relu</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> keras
<span class="im">from</span> keras.layers <span class="im">import</span> Dense
<span class="im">from</span> keras.models <span class="im">import</span> Sequential
<span class="co"># Specify the model: Two hidden layers</span>
model <span class="op">=</span> Sequential()
<span class="co">## Input</span>
n_cols <span class="op">=</span> predictors.shape[<span class="dv">1</span>]
model.add(Dense(<span class="dv">50</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (n_cols,)))
<span class="co"># Hidden</span>
model.add(Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>))
<span class="co"># Output</span>
model.add(Dense(<span class="dv">1</span>))
<span class="co"># Compile the model</span>
model.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">&#39;adam&#39;</span>, loss <span class="op">=</span> <span class="st">&#39;mean_squared_error&#39;</span>) 
<span class="co"># Fit the model</span>
model.fit(predictors, target)
<span class="co">#Look at summary</span>
model.summary()
<span class="co"># Calculate predictions: predictions</span>
predictions <span class="op">=</span> model.predict(pred_data)</code></pre></div>
</div>
<div id="classification" class="section level3">
<h3><span class="header-section-number">13.5.2</span> Classification</h3>
<ul>
<li><p>loss = categorical_crossentropy</p></li>
<li><p>metric = accuracy</p></li>
<li><p>activation_function = softmax</p></li>
<li><p>output layer with stuff equal to number of categorical groups</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> keras
<span class="im">from</span> keras.layers <span class="im">import</span> Dense
<span class="im">from</span> keras.models <span class="im">import</span> Sequential
<span class="co"># Specify the model: Two hidden layers</span>
n_cols <span class="op">=</span> predictors.shape[<span class="dv">1</span>]
model <span class="op">=</span> Sequential()
<span class="co">## Input</span>
model.add(Dense(<span class="dv">50</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (n_cols,)))
<span class="co"># Hidden</span>
model.add(Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>))
<span class="co"># Output</span>
model.add(Dense(<span class="dv">2</span>, activation <span class="op">=</span> <span class="st">&#39;softmax&#39;</span>))
<span class="co"># Compile the model</span>
model.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">&#39;sgd&#39;</span>, loss <span class="op">=</span> <span class="st">&#39;categorical_crossentropy&#39;</span>, metrics <span class="op">=</span> [<span class="st">&#39;accuracy&#39;</span>])
<span class="co"># Fit the model</span>
model.fit(predictors, target)
<span class="co">#Look at summary</span>
model.summary()
<span class="co">#Calculate predictions: predictions</span>
predictions <span class="op">=</span> model.predict(pred_data)
<span class="co">#Calculate predicted probability of survival</span>
predicted_prob_true <span class="op">=</span> predictions[:, <span class="dv">1</span>]</code></pre></div>
</div>
<div id="more" class="section level3">
<h3><span class="header-section-number">13.5.3</span> More</h3>
<p>keras: declare model | compile with loss, optimizer, and scoring metric | fit | keras::to_categorical</p>
<p>keras.callbacks.EarlyStopping: Stop training when validation score stop improving after a certain number of epochs (baches?)</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># Import the SGD optimizer</span>
<span class="im">from</span> keras.optimizers <span class="im">import</span> SGD
<span class="co"># Create list of learning rates: lr_to_test</span>
lr_to_test <span class="op">=</span> [.<span class="dv">000001</span>, <span class="fl">0.01</span>, <span class="dv">1</span>]
<span class="co"># Loop over learning rates</span>
<span class="cf">for</span> lr <span class="kw">in</span> lr_to_test:
    <span class="bu">print</span>(<span class="st">&#39;Testing model with learning rate: &#39;</span>)
    
    <span class="co"># Build new model to test, unaffected by previous models</span>
    model <span class="op">=</span> get_new_model()
    
    <span class="co"># Create SGD optimizer with specified learning rate: my_optimizer</span>
    my_optimizer <span class="op">=</span> SGD(lr <span class="op">=</span> lr)
    
    <span class="co"># Compile the model</span>
    model.<span class="bu">compile</span>(optimizer <span class="op">=</span> my_optimizer, loss <span class="op">=</span> <span class="st">&#39;categorical_crossentropy&#39;</span>)
    
    <span class="co"># Fit the model</span>
    model.fit(predictors, 
              target, 
              validation_split <span class="op">=</span> <span class="fl">0.3</span>, 
              epochs <span class="op">=</span> <span class="dv">20</span>, 
              callbacks <span class="op">=</span> [early_stopping_monitor], 
              verbose <span class="op">=</span> <span class="va">False</span>)</code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="code-snippets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/11-frameworks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
